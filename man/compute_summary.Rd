% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/indicator_fns.R
\name{compute_summary}
\alias{compute_summary}
\title{Compute summary statistics for selected variables}
\usage{
compute_summary(
  data,
  cols = list(vars = NULL, groups = "year"),
  fns = list(default = c("sum", "mean", "median", "cv"), user = NULL),
  output = c("long", "wide")
)
}
\arguments{
\item{data}{A data frame or tibble containing the variables to summarize.}

\item{cols}{A list specifying which columns to summarize and which to group by.
Must include:
\itemize{
  \item \code{vars} — Character vector of variable names to summarize.
  \item \code{groups} — Character vector of grouping variables (defaults to \code{"year"}).
}}

\item{fns}{A list specifying which summary functions to apply.
Must include:
\itemize{
  \item \code{default} — Character vector of names of built-in summary functions to use.
    Available options are \code{"sum"}, \code{"mean"}, \code{"median"}, and \code{"cv"}.
  \item \code{user} — Optional named list of user-defined functions written in
    formula syntax (e.g., \code{list(p90 = ~quantile(.x, 0.9, na.rm = TRUE))}).
}}

\item{output}{A character string specifying the desired output format.
Must be one of:
\itemize{
  \item \code{"long"} — Returns a tidy long-format tibble with \code{indicator} and \code{value} columns.
  \item \code{"wide"} — Returns a wide-format tibble with one column per computed statistic.
}}
}
\value{
A tibble containing the requested summary statistics, either:
\itemize{
  \item In *long* format: grouping variables, \code{indicator}, and \code{value}.
  \item In *wide* format: grouping variables and one column per computed statistic.
}
}
\description{
Computes one or more summary statistics for a set of numeric variables in a
data frame, optionally grouped by specified variables (e.g., year, department, etc.).
Supports both built-in summary statistics (sum, mean, median, cv) and user-defined
functions, with flexible output in either long or wide format.
}
\details{
The function summarizes numeric variables using the specified statistics and optionally
reshapes the output into long format. The coefficient of variation (\code{cv}) is assumed
to be available as a helper function (e.g., \code{cv <- function(x) sd(x, na.rm = TRUE) / mean(x, na.rm = TRUE)}).
}
\examples{
# Example data
df <- tibble::tibble(
  year = rep(2020:2022, each = 3),
  department = rep(c("A", "B", "C"), 3),
  wage = c(1000, 1200, 1100, 1500, 1300, 1400, 1600, 1550, 1500),
  bonus = c(100, 120, 110, 150, 130, 140, 160, 155, 150)
)

# Compute mean and sum of wages and bonuses by year and department (long)
compute_summary(
  data = df,
  cols = list(vars = c("wage", "bonus"), groups = c("year", "department")),
  fns = list(default = c("sum", "mean")),
  output = "long"
)

# Same computation, wide format
compute_summary(
  data = df,
  cols = list(vars = c("wage", "bonus"), groups = c("year", "department")),
  fns = list(default = c("sum", "mean")),
  output = "wide"
)

# Add a user-defined percentile function
compute_summary(
  data = df,
  cols = list(vars = c("wage"), groups = "year"),
  fns = list(
    default = c("mean"),
    user = list(p90 = ~quantile(.x, 0.9, na.rm = TRUE))
  ),
  output = "long"
)

}
