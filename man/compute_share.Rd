% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/summary_statistics.R
\name{compute_share}
\alias{compute_share}
\title{Compute Shares of Summary Indicators Relative to Macro Indicators}
\usage{
compute_share(
  data,
  macro_data = macro_indicators,
  macro_cols,
  cols,
  groups,
  fns,
  output = c("long", "wide")
)
}
\arguments{
\item{data}{A data frame containing the microdata to be summarized.}

\item{macro_data}{A data frame containing macro-level indicators. Defaults to
\code{macro_indicators} if available in the environment.}

\item{macro_cols}{A character vector specifying the names of the macro
indicator columns in \code{macro_data} to use for share computation.}

\item{cols}{A named list passed to \code{compute_summary()}, specifying
which variables to summarize (e.g. \code{list(vars = "varname")}).}

\item{groups}{A character vector specifying the grouping variables common to
both datasets. Defaults to \code{c("country_code", "ref_date")}.}

\item{fns}{A list of summary functions passed to \code{compute_summary()},
typically defined as formulas (e.g. \code{list(mean = ~mean(.x, na.rm = TRUE))}).}

\item{output}{Character string indicating the desired output format:
\code{"long"} (default) for a tidy data frame with one row per share, or
\code{"wide"} for a data frame with one column per computed indicator.}
}
\value{
A data frame containing the computed ratios (shares).
If \code{output = "long"}, columns include:
\itemize{
  \item Grouping variables (e.g., \code{country_code}, \code{ref_date})
  \item \code{macro_var}, \code{macro_value}
  \item \code{summary_var}, \code{summary_value}
  \item \code{indicator} – constructed name of the ratio
  \item \code{value} – computed share
}
If \code{output = "wide"}, each ratio indicator is returned as a separate column.
}
\description{
This function calculates the ratio (share) of summarized microdata indicators
to macro-level indicators (e.g., GDP, total population, etc.). It automatically
detects common join keys between the micro-level summary and macro-level data,
merges them, and computes the ratios for all possible combinations of
summarized and macro variables.
}
\details{
The function proceeds in five steps:
\enumerate{
  \item Summarizes the microdata using \code{compute_summary()}.
  \item Automatically detects join keys shared between the summary and macro data.
  \item Merges the summarized and macro data on those join keys.
  \item Computes the ratio of each summarized indicator to each macro indicator.
  \item Formats the output as either long or wide form, depending on the \code{output} argument.
}

The output always includes the computed shares (e.g. \code{employment_per_GDP}),
as well as the underlying macro and summary values used to compute them.
}
\examples{
\dontrun{
# Example usage
compute_share(data = contract_harmonized,
              macro_cols = c("gdp_lcu", "prevenue_lcu"),
              cols = c("gross_salary_lcu", "net_salary_lcu"),
              fns = c("mean", "sum"),
              output = "wide")
}

}
\seealso{
\code{\link{compute_summary}}
}
